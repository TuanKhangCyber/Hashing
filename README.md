# üîê Hashing

---

## üìå Introduction  
<img src="https://github.com/user-attachments/assets/b7a534e4-11cb-4ce1-9c4e-87f746b76fd1" width="600">

Consider the scenario where you just downloaded a 6 GB file and want to know whether the copy you downloaded is identical to the original file, bit for bit. How would you do that? Or if a good Samaritan handed you this 6 GB file on a USB memory drive, how can you be sure it is identical to the file you want to download?

The answer to both of the above questions lies in comparing the hash values of the two files; if two hash values are equal, you can say with very high certainty that the two files are identical.

A hash value is a fixed-size string generated by a **hash function**. Hashing is **one-way** and cannot be reversed.

---

## üß† Room Prerequisites

- Cryptography Basics  
- Public Key Cryptography Basics  
- Hashing Basics (this room)

---

## üéØ Learning Objectives

You will learn:

- Hash functions and collisions  
- Hashing in authentication  
- Recognizing stored hash values  
- Cracking hashes  
- Integrity verification  

---

## 1Ô∏è‚É£ Hash Functions

Hash functions:

- Take any input size ‚Üí fixed-size output  
- Impossible (or impractical) to reverse  
- Small input change = large output change (Avalanche Effect)

Example commands:

```bash
md5sum *.txt
sha1sum *.txt
sha256sum *.txt
```

Even though the files differ by one bit, **MD5, SHA1 and SHA-256** hashes are completely different.

### Output Encoding

- Raw output: **bytes**
- Common encodings:
  - Hexadecimal (default in CLI tools)
  - Base64

---

### Why Hashing Matters

Hashing is used to:

- Verify passwords  
- Detect tampering  
- Authenticate data integrity  

---

### Hash Collisions

A collision occurs when **two different inputs produce the same hash**.  
Due to limited output size, collisions are mathematically unavoidable (pigeonhole principle).

‚ö†Ô∏è **MD5 and SHA-1 are considered insecure.**

---

### ‚úî Task Answers

| Question | Answer |
|---------|--------|
| SHA256 of passport.jpg | `77148c6f605a8df855f2b764bcc3be749d7db814f5f79134d2aa539a64b61f02` |
| MD5 output size | `16 bytes` |
| 8-bit hash possible values | `256` |

---

## 2Ô∏è‚É£ Insecure Password Storage

Common bad practices:

- ‚ùå Storing plaintext passwords  
- ‚ùå Using deprecated encryption  
- ‚ùå Using weak/un-salted hash functions  

Example breach lists: RockYou, LinkedIn, Adobe.

| Question | Answer |
|----------|--------|
| 20th password in rockyou.txt | `qwerty` |

---

## 3Ô∏è‚É£ Secure Password Storage

Modern secure method:

‚úî Use a strong algorithm: Argon2, bcrypt, scrypt, PBKDF2  
‚úî Use a unique salt  
‚úî Store: `salt + hash`, not passwords  
‚úî Do NOT encrypt passwords

Example rainbow table entry:

```
4c5923b6a6fac7b7355f53bfe2b8f8c1 ‚Üí inS3CyourP4$$
```

| Question | Answer |
|----------|--------|
| Crack `5b31f93c09ad1d065c0491b764d04933` | `tryhackme` |
| Should passwords be encrypted? | `YES` |

---

## 4Ô∏è‚É£ Recognising Hash Formats

Linux password format (`/etc/shadow`):

```
$prefix$options$salt$hash
```

Prefix samples:

| Prefix | Algorithm |
|--------|-----------|
| `$y$` | yescrypt |
| `$7$` | scrypt |
| `$2b$ $2y$` | bcrypt |
| `$6$` | SHA-512 crypt |
| `$1$` | MD5 crypt |

| Question | Answer |
|----------|--------|
| yescrypt size | `256` |
| Cisco-ASA MD5 hash mode | `2410` |
| Cisco-IOS ($9$) algorithm | `scrypt` |

---

## 5Ô∏è‚É£ Password Cracking

Tools:

- Hashcat  
- John the Ripper  

Syntax example:

```bash
hashcat -m <hash_type> -a 0 hash.txt /usr/share/wordlists/rockyou.txt
```

Cracked results:

| Hash | Value |
|------|-------|
| `$2a$06$7yoU3...` | `85208520` |
| `9eb7ee...e8e1` | `halloween` |
| `$6$GQXV...` | `spaceman` |
| `b6b0d451bbf6fed658659a9e7e5598fe` | `funforyou` |

---

## 6Ô∏è‚É£ Integrity Checking & HMAC

Hashing can validate files:

```
sha256sum myfile.iso
```

If the output matches, the file is unchanged.

HMAC = Hash + Secret Key  
Used for **integrity + authenticity**.

| Question | Answer |
|----------|--------|
| SHA256 hash of libgcrypt-1.11.0.tar.bz2 | `09120c9867ce7f2081d6aaa1775386b98c2f2f246135761aae47d81f58685b9c` |
| Hashcat mode for HMAC-SHA512 | `1750` |

---

## 7Ô∏è‚É£ Conclusion: Hashing vs Encoding vs Encryption

| Feature | Hashing | Encoding | Encryption |
|---------|---------|----------|------------|
| Reversible | ‚ùå No | ‚úî Yes | ‚úî Yes |
| Purpose | Integrity | Formatting | Confidentiality |
| Uses | Passwords, signatures | Transport, storage | Secure communication |

Final answer:

| Question | Answer |
|----------|--------|
| Decode Base64 `RU5jb2RlREVjb2RlCg==` | `ENcodeDEcode` |

---

